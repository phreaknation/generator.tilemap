!function(){"use strict";var e,t,i,n="tilemap_generator",r="TilemapGenerator",o=[0,0,1],s="Generates a tilemap based on perlin noise.",u="Joel Dies <phreaknation@gmail.com>",h={height:32,width:32},a={height:32,width:32},p={},d=function(e,t){return Phaser.Plugin.call(this,e,t),"undefined"==typeof console.error&&(console.error=console.log),this.game=e,this.parent=t,this.schemas=p,this.tileRegistry=[],this.rotation=[[0,-1],[1,-1],[1,0],[1,1],[0,1],[-1,1],[-1,0],[-1,-1]],this};d.prototype=Object.create(Phaser.Plugin.prototype),d.prototype.constructor=Phaser.Plugin.SamplePlugin,d.prototype.description=function(){return _.toTitleCase(_.replace(n,/\_/g," "))+" plugin by "+u+". "+s},d.prototype.generateGrid=function(t,i,n,r,o){var s=0,u=[],h=this.getPerlinFunction();for(t=t||0,i=i||0,r=r||{height:this.getGridSize("height"),width:this.getGridSize("width")},o=o||e,s=0;s<parseFloat(r.width);){for(var a=[],p=0;p<parseFloat(r.height);){var d=(s+t+o)/16,l=(p+i+o)/16,c=h(d,l,0);_.isFunction(n)&&a.push(n(c,s,p)),p++}s++,u.push(a)}return u},d.prototype.generateSeed=function(e){var t=[],i=this.random();return e=e||1e3,_.times(e,function(){var e=i.next();t.push(e)}),t[t.length-1]},d.prototype.getGridSize=function(e){return e=_.toLower(e)||"width",Object.keys(h).indexOf(e)!==-1&&h[e]},d.prototype.getPerlin=function(){return t},d.prototype.getPerlinFunction=function(){return i},d.prototype.getSeed=function(){return e},d.prototype.getTileSize=function(e){return e=_.toLower(e)||"width",Object.keys(a).indexOf(e)!==-1&&a[e]},d.prototype.loadPerlin=function(t,i){_.isUndefined(i)||(i=e),this.setSeed(i),this.perlin=new t(this.getSeed())},d.prototype.mapRender=function(e,t,i,n){return this.tileRegistry=[],_.each(this.rotation,function(n){var r,o,s;if(o=t+n[0]*this.getTileSize("width"),s=i+n[1]*this.getTileSize("height"),r=this.tileInCamera(e.camera,{x:o,y:s}))return this.TileRegistry.push({x:o,y:s})})},d.prototype.random=function(){var t,i=Math.pow(2,13)+1,n=47417,r=1e3;return _.isNumber(e)&&(t=e),null===t&&(t=this.seedRandom()),{next:function(e,o){for(;t>i;)t/=n;return t*=i,t+=n,void 0!==e&&void 0!==o?Math.floor(e+t%r/r*(o-e)):t%r/r}}},d.prototype.seedRandom=function(){var t=1e3*Math.sin(e++);return t-Math.floor(t)},d.prototype.setGridSize=function(e,t){return!!_.isNumber(e)&&(_.isUndefined(t)&&(t=e),h={height:t,width:e})},d.prototype.setPerlin=function(e,i,r){var o="setPerlin";if(_.isUndefined(i)?i=this.getSeed():r===!0&&this.setSeed(i),_.isNumber(i)){if(_.isFunction(e))return t=new e(i);console.error("[%s][%s] Perlin library must be a function.",n,o)}else console.error("[%s][%s] Seed has not been set. Please use the setSeed function, or pass it as a second parameter.",n,o);return!1},d.prototype.setPerlinFunction=function(e){var t="setPerlin";return _.isFunction(e)?i=e:(console.error("[%s][%s] Function supplied is not a function.",n,t),!1)},d.prototype.setSeed=function(t){return!!_.isNumber(t)&&(e=t)},d.prototype.setTileSize=function(e,t){return!!_.isNumber(e)&&(_.isUndefined(t)&&(t=e),a={height:t,width:e})},d.prototype.tileInCamera=function(e,t){var i,n,r,o,s,u;return!_.isUndefined(e)&&(!_.isUndefined(t)&&(r=t.x,s=t.x+this.getTileSize("width"),n=e.x+e.width,r>e.x&&s<n&&(o=t.y,u=t.y+this.getTileSize("height"),i=e.y+e.height,o>e.y&&u<i)&&-1!==_.findIndex(this.tileRegistry,function(e,t){if(e.x===r&&e.y===o)return!0})))},d.prototype.version=function(){return o.join(".")},window.PhreakNation=window.PhreakNation||{},window.PhreakNation.Plugins=window.PhreakNation.Plugins||{},window.PhreakNation.Plugins[r]=d}();